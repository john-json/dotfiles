# Packages
brew install lua
brew install switchaudio-osx
brew install nowplaying-cli

brew tap FelixKratz/formulae
brew install sketchybar

# Fonts
brew install --cask sf-symbols
brew install --cask homebrew/cask-fonts/font-sf-mono
brew install --cask homebrew/cask-fonts/font-sf-pro
brew install --cask font-hack-nerd-font

#!/bin/bash

echo "Installing SketchyBar launcher..."

# Copy the script to /usr/local/bin
sudo cp sketchybar-launch /usr/local/bin/sketchybar-launch
sudo chmod +x /usr/local/bin/sketchybar-launch

# Function to add alias if not already present
add_alias() {
    local shell_config=$1
    local alias_cmd='alias sketchybar="sketchybar-launch"'

    if ! grep -Fxq "$alias_cmd" "$shell_config"; then
        echo "$alias_cmd" >>"$shell_config"
        echo "Added alias to $shell_config"
    else
        echo "Alias already exists in $shell_config"
    fi
}

# Add alias to both Zsh and Bash configs
add_alias ~/.zshrc
add_alias ~/.bashrc

# Apply changes
source ~/.zshrc 2>/dev/null || source ~/.bashrc

echo "Installation complete! Now you can use:"
echo "  sketchybar       # Default bar"
echo "  sketchybar --full  # Full bar"

git clone https://github.com/john-json/colorswitch.git ~/.config/sketchybar/helpers/
cd colorswitch
sudo make install

# Update permissions
chmod +x ~/.config/sketchybar/items/scripts/colorswitch.sh

mkdir -p ~/Library/LaunchAgents
cp /Users/$(id -u)/.config/sketchybar/items/plists/com.user.colorswitch.plist ~/Library/LaunchAgents/

launchctl bootstrap gui/$(id -u) ~/Library/LaunchAgents/com.user.colorswitch.plist
plutil -lint /Users/$(id -u)/Library/LaunchAgents/com.user.colorswitch.plist

log stream --predicate 'subsystem == "com.apple.UIKit"'

curl -L https://github.com/kvndrsslr/sketchybar-app-font/releases/download/v2.0.5/sketchybar-app-font.ttf -o $HOME/Library/Fonts/sketchybar-app-font.ttf

# SbarLua
(git clone https://github.com/FelixKratz/SbarLua.git /tmp/SbarLua && cd /tmp/SbarLua/ && make install && rm -rf /tmp/SbarLua/)
